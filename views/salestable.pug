extends layout2.pug 

block content 
  div(style="width: 100%; height: 100vh; display: flex; flex-direction: row;")
    div(style="width: 25%; height: 100%;")
      include includes/sidebar.pug

    div(style="width: 75%; padding: 20px; overflow-y: auto;")
      .container.my-5.mt-6
        h3.mb-4 Sales Records
        .d-flex.justify-content-between.mb-3
          input.form-control(type='text', placeholder='Search Sales...', id='searchInput', style='width: 50%;')
          a.btn.btn-dark(href='/Addsale')
            | Add Sale

        table.table.table-striped.table-bordered
          thead.table-dark
            tr
              th(scope='col') Customer Name
              th(scope='col') Product Type
              th(scope='col') Product Name
              th(scope='col') Quantity
              th(scope='col') Unit Price
              th(scope='col') Transport
              th(scope='col') Total Price 
              th(scope='col') Sales Agent 
              th(scope='col') Payment Type
              th(scope='col') Date 
              if currentUser.role === "Manager"
                th(scope='col') Update 
                th(scope='col') Delete
              th(scope='col') Receipt 
          tbody
            if sales.length 
              each sale in sales 
                tr 
                  td #{sale.customerName}
                  td #{sale.productType}
                  td #{sale.productName}
                  td #{sale.quantity}
                  td #{sale.unitPrice}
                  td #{sale.transportCheck}
                  td #{sale.totalPrice}
                  td #{sale.salesAgent.userName}
                  td #{sale.paymentType}
                  td #{moment(sale.paymentDate).format("DD-MM-YYYY")}
                  if currentUser.role === "Manager"
                    td
                        a.btn.btn-warning.btn-sm(href=`/editsale/${sale._id}`)
                        i.bi.bi-pencil-square
                    td
                        form(method='post' action="/deletesale")
                        input(type="hidden" name='id' value=sale._id)
                        button.btn.btn-danger.btn-sm(type='submit')
                            i.bi.bi-trash
                  td
                    a.btn.btn-info.btn-sm(href=`/getReceipt/${sale._id}`)
                      i.bi.bi-receipt
           

      script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js')
    
